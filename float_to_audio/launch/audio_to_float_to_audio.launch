<?xml version="1.0"?>
<launch>
  <arg name="ns" default="audio" doc="namespace"/>
  <arg name="format" default="mp3" doc="mp3 or flac"/>
  <arg name="float_sample_rate" default="16000"/>

  <include file="$(find audio_capture)/launch/capture.launch">
  </include>
  <group ns="$(arg ns)">
    <node name="audio_to_float1" pkg="audio_to_float" type="audio_to_float"
        output="screen">
      <remap from="audio" to="audio"/>
      <remap from="decoded" to="decoded"/>
    </node>

    <node name="view_input" pkg="audio_to_float" type="view.py">
      <!--remap from="decoded" to="samples"/>
      <remap from="image" to="image_input"/-->
      <remap from="image" to="image"/>
      <param name="fade1" value="0.5"/>
      <param name="fade2" value="0.5"/>
    </node>

    <!-- TODO(lucasw) this currently isn't working -->
    <node name="float_to_audio" pkg="float_to_audio" type="float_to_audio"
        output="screen">
      <param name="input_sample_rate" value="$(arg float_sample_rate)"/>
      <param name="format" value="$(arg format)"/>
      <remap from="audio" to="audio2"/>
      <remap from="samples" to="decoded"/>
    </node>

    <node name="audio_play" pkg="audio_play" type="audio_play" output="screen">
      <param name="dst" value="alsasink"/>
      <remap from="audio" to="audio2"/>
    </node>

    <node name="audio_to_float2" pkg="audio_to_float" type="audio_to_float"
        output="screen">
      <remap from="audio" to="audio2"/>
      <remap from="decoded" to="decoded2"/>
    </node>
    <node name="view_output" pkg="audio_to_float" type="view.py">
      <remap from="decoded" to="decoded2"/>
      <remap from="image" to="image_output"/>
      <param name="fade1" value="0.5"/>
      <param name="fade2" value="0.5"/>
    </node>

    <!-- TODO(lucasw) rqt config/float_to_audio.perspective -->
    <node name="rqt" pkg="rqt_gui" type="rqt_gui"
        args="-p $(find float_to_audio)/config/float_to_audio.perspective"/>

  </group>
</launch>
